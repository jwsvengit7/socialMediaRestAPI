package com.example.api.Controllers;import com.example.api.Entity.Post;import com.example.api.Response.ApiResponse;import com.example.api.DTO.PostRequestDTO;import com.example.api.ServicesImpl.PostServiceImplementation;import com.example.api.ServicesImpl.UserServiceImplementations;import lombok.RequiredArgsConstructor;import lombok.extern.slf4j.Slf4j;import org.springframework.http.HttpStatus;import org.springframework.http.ResponseEntity;import org.springframework.security.core.context.SecurityContextHolder;import org.springframework.security.core.userdetails.UserDetails;import org.springframework.web.bind.annotation.*;import java.util.List;@RestController@RequiredArgsConstructor@RequestMapping("api/v1/post")@Slf4jpublic class PostController {    private final PostServiceImplementation blogPost;    private final UserServiceImplementations userServiceImplementation;    @PostMapping("/add")    public ResponseEntity<ApiResponse> addPost(@RequestBody PostRequestDTO postDTO){        log.info("------{}", SecurityContextHolder.getContext().getAuthentication());        UserDetails userDetails = (UserDetails) SecurityContextHolder.getContext().getAuthentication().getPrincipal();        PostRequestDTO postDTO1 = blogPost.addPost(postDTO,userDetails.getUsername());        return  ResponseEntity.ok().body(                ApiResponse.builder().                        data(postDTO1)                        .message("post")                        .build()        );    }    @PutMapping("{postId:[\\d]+}")    public ResponseEntity<ApiResponse<PostRequestDTO>> updatePost(@RequestBody PostRequestDTO request,@PathVariable Long postId) {        UserDetails userDetails = (UserDetails) SecurityContextHolder.getContext().getAuthentication().getPrincipal();        var authorId = blogPost.updatePost(request,postId,userDetails.getUsername());        return ResponseEntity.status(HttpStatus.FORBIDDEN).body(                ApiResponse.<PostRequestDTO>builder()                        .message((authorId!=null)?"You Can Update":"You are not the author of this post")                        .status(HttpStatus.FORBIDDEN)                        .build()        );    }    @DeleteMapping("delete/{postid}")    public ResponseEntity<Object> delete(@PathVariable("postid") Long postid){        UserDetails userDetails = (UserDetails) SecurityContextHolder.getContext().getAuthentication().getPrincipal();        blogPost.deletePost(postid,userDetails.getUsername());        return new ResponseEntity<>("DELETED",HttpStatus.GONE);    }    @GetMapping("/allPost")    public ResponseEntity<ApiResponse> getAll(){        List<Post> post = blogPost.getAllPost();        return ResponseEntity.status(HttpStatus.OK).body(                ApiResponse.builder()                        .message("SUCCESS")                        .data(post)                        .status(HttpStatus.CONTINUE).build()        );    }}